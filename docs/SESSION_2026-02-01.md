# Dev Session Notes - Feb 1, 2026

Quick notes from today's session (vibe coded with Claude).

---

## What We Fixed

### 1. Waterfall "Offline" Bug (UX Issue)

**The Problem:**
When capturing a satellite pass, the waterfall would just say "OFFLINE" - which looked broken. Actually it's supposed to do that (SDR can only do one thing at a time), but users couldn't tell if it was a bug or expected behavior.

**The Fix:**
Added a proper overlay to the waterfall component showing "ðŸ“¡ Capturing Satellite Signal" with an explanation. Now it's obvious the pause is intentional.

Two cases handled:
- If waterfall hasn't started yet: Shows capture message instead of "FFT stream not running"
- If waterfall is already going: Dims it with a semi-transparent overlay and shows the capture message

**Files touched:**
- `src/frontend/src/components/WaterfallView.tsx` (lines 105-114, 213-231)

Deployed successfully, frontend build took about 7.5 seconds thanks to the Docker layer optimization we did earlier.

---

### 2. Repository Cleanup

**What was messy:**

1. **Too many .env.example files**
   - Root had one (minimal)
   - `.appcontainer/` had one (better documented)
   - `scripts/deploy/` had one (deployment-specific)

2. **Weird .appcontainer directory**
   - Only had an .env.example in it
   - Not a standard (unlike .devcontainer which VS Code actually uses)
   - All real Docker stuff was in `docker/` anyway

3. **Outdated docs**
   - DEPLOYMENT.md said version 1.0.0 (we're on 2.0.0)
   - Referenced wrong branch (master instead of main)
   - Old paths (`./deploy/` â†’ should be `scripts/deploy/`)

4. **.gitignore gaps**
   - Missing `.bun/` directory
   - Some test output patterns weren't covered

**What we did:**

#### Nuked .appcontainer
Considered keeping it for symmetry with `.devcontainer`, but decided against it:
- `.devcontainer` is special - VS Code looks for it
- `.appcontainer` isn't a thing anyone recognizes
- All our Docker stuff is already in `docker/` with good docs

So we deleted it and merged its better .env.example into the root one.

#### Cleaned up .env.example
Took the well-commented version from `.appcontainer`, improved it, put it in root:
- Clear section headers
- Helpful comments
- Notes about Docker vs local paths
- Organized by category

#### Updated .gitignore
Added:
- `.bun/` directory
- `.vscode/*.code-workspace`
- More log patterns
- Test output dirs explicitly listed
- Kept bun.lockb for reproducible builds (commented)

#### Fixed docs
**DEPLOYMENT.md:**
- Version bumped to 2.0.0
- Branch corrected to main
- All paths updated (`.appcontainer/.env.example` â†’ `.env.example`, `./deploy/` â†’ `scripts/deploy/`)
- Added note explaining why we use `docker/` instead of `.appcontainer/`

**README.md:**
- Fixed Quick Start to use `.env.example` instead of `.appcontainer/.env.example`

---

## Earlier Session Context

(Stuff we did before the cleanup)

### SSTV Scanner Fixes
- Fixed timeout bug - scanner was running forever
- Increased dwell time from 3s to 20s (less waterfall churn)
- File: `src/backend/capture/sstv-scanner.ts`

### Deploy Script Improvements
- SSH agent support (no more hardcoded key paths)
- Better version extraction (grep instead of node)
- Fixed paths for nested directory structure
- File: `scripts/deploy/deploy.sh`

### Docker Build Speedup
- Separated frontend deps from source copy
- UI-only changes now build in ~20-30s instead of 7 minutes
- File: `docker/Dockerfile.app`

---

## Technical Decisions

### Why `docker/` not `.appcontainer/`?

Even though `.appcontainer` would look nice next to `.devcontainer`, we stuck with `docker/` because:
- Industry standard location
- `.devcontainer` is special (VS Code finds it), `.appcontainer` isn't
- Everything's already there
- Not worth the churn

Documented this in DEPLOYMENT.md so future us remembers why.

### .env.example Setup

Kept two:
- Root `.env.example` - main config template
- `scripts/deploy/.env.example` - deployment-specific

Keeps deployment stuff separate from regular config.

---

## Files Changed

**Modified:**
- `src/frontend/src/components/WaterfallView.tsx` - capture overlay
- `.env.example` - consolidated, better docs
- `.gitignore` - filled gaps
- `docs/DEPLOYMENT.md` - version, paths, structure note
- `README.md` - removed .appcontainer ref

**Deleted:**
- `.appcontainer/` directory

**Kept:**
- `.devcontainer/` - VS Code needs it
- `docker/` - production standard
- `scripts/deploy/` - deployment tools

---

## What's Next

- Test the new waterfall overlay during next satellite pass
- Maybe add toast notifications for frequency changes (user wanted this)
- Keep eye on Docker build times
- Bump to 2.0.1 when we have more changes

---

## Quick Ref

**Version:** 2.0.0
**Branch:** main
**Last Deploy:** Feb 1, 2026

### Common Commands
```bash
# Setup
cp .env.example .env
vi .env  # add your coords

# Deploy
cd scripts/deploy
./deploy.sh

# Docker stuff
docker compose -f docker/compose.yaml up -d
docker compose -f docker/compose.yaml logs -f
docker compose -f docker/compose.yaml down
```

### Directory Layout
- Production configs: `docker/`
- Dev container: `.devcontainer/`
- Deploy scripts: `scripts/deploy/`
- Docs: `docs/`

---

*Session summary for context in future convos. Built with vibes and Claude.*
